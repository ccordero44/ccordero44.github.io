<meta http-equiv="x-ua-compatible" content="IE=edge">
<html prefix="og: http://ogp.me/ns#">
<meta property="og:title" content="Shop Locator">
<meta name="description" property="og:description" content="Custom Body Shop or Store Locator developed using Javascript, CSS and some HTML elements.">
<meta name="image" property="og:image" content="https://ccordero44.github.io/thumbnail.jpg">
<meta property="og:url" content="https://ccordero44.github.io/">
<meta name="author" content="Carlos Cordero">
<meta property="fb:app_id" content="318868405607764" />
<meta property="og:type" content="website" />


<!DOCTYPE html>

<html>

<head>
    <title>Shop Locator</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <Link rel="stylesheet" type="text/css" href="stylesheet.css">
    <script type="text/javascript" src="onload.js"></script>
    <script src="fontawesome.js"></script>
    <script src="jQuery v3.js"></script>
    <script src="jQuery Migrate.js"></script>
	<script type="text/javascript" src="counties.js"></script>
    <script src="sorttable.js"></script>
    <script type="text/javascript" src="read-csv.js"></script>
    <script type="text/javascript" src="mapfunctions.js"></script>
    <script type="text/javascript" src="list.js"></script>
</head>

<body>

   <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js"></script>
   <script type="text/javascript">

		window.onload = Window_onLoad;

	        var image = {
	            url: 'https://mt.googleapis.com/vt/icon/name=icons/onion/999-biz-car-repair.png'
	        };
	
	        var image2 = {
	            url: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAA8CAYAAADPAlLCAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAtTSURBVGhD7ZkLcFTVGcfP3bvPJBs2DwIqGOURkLEindqxiLYVoWB4g0pErFoqtlNH1KrYzvgYbJ3aaa1Fp2LbqRarnYrPVhEQdHwUxSoI5J3dJJuEsMkm2ffeu3vv3v7P2ZPsJu4r2XWmneE3c+fc8927997/+b7zne/eJWc4Q+EQeFtwTCbTyLVlWdb47ldCwUT8bPu9tpgaW917+vScSDR6lSTJs90DA8V+v58oihIwGAxBSZKacOph9I+53e43h4aG5Piv8yNvET+9a9siTdNqfT7/bc6uLttpVx+JRqP8aGbwuz3BYPBep9PZzk0TYsIi7rvnblssFrvL6/Ntb221G1x9ffzI+MF13oTwLXa7/TQ3jYsJifjR1i2XWiyW33c6uy9pszvGjnwMI/wZ2sN4uLfQ+qixvLysymwyXQbb9YFA8JywJFHzCPiNjDBb2draeoCbcmbcIrb+8JZvFRUVvWV3tNva7KOigD78G+FweHtHR0czt6VkzcoVqyFmZ597YLoPcyYZVVW3Nzc3/4p3c2JcIm79wc0LIOBQq91ha+/o5FYWDsew/bKlpeUlbsqJNatqH5Uj0e3Orh7qCW4lNBHchGs9x7tZyVnEjZvqKq1W6+t9/e6F9Y00ycTBwz+P5idNTU3euGV8LF1y5Q0Is92dEBKNKtxKCDLZQofDcZh3M6LjbVaKi4t3IN8vbGmzcwsT8DqaCQug7D9w6Hmk5iXV084hRoOBW9k6k7NXRd5m5Jbvb16v14uPUQF+f4DZ4P4WQRBW5CNgGFzXMeP88861WksWeH3xOYJrl5aVlQkDAwPvMUMGcgqnrVtufhUXX3P8ZAO3MC/UQcDf6b526xZbwGR+SPUH5gd646lWlaRTOp3OJxqNrC8HAqdEs5nQTa9pAb97oNsUjR6YfvRTDz0+b+4cC4Q4g6FwpavfzX6DgYpAzJSGhgZ2Tjqyiti8aeOlRRbL4eZWO8F8YDaahRobG1ezDvBsqqubZDS+0O9wkqDXnyozncNbBsSV6DCRMZWHzj36aTk3k+VLF2/Gsb86u3uJGosxG+51O+71JOukIeucEDSykeb0gcEh1sdFo/DCH1iHYxLFVYocIbIvQHyquuX8Y/+ZO2azJm/haVWfhM6qpCNY9s4FF07ilyHNrW3/QOMtLxsx0fvdwXfTklUExmuBx+Ol+Zv14d6TyONvsw6YabXqdES4JBqSiBSLOeafOPohP5QWURCOGAx6tj9JFBezHeBo75RFUfxLaUkJ9RazoZ1VU1Mz4q1UZBTxvSWLS/DQCxCn3MJG5iDfZby15KrZRp1upoQJj/D4gpszgvP6MRr0CUmxTryAmxlaTHufHjIZE5kKnr+S76YkPhxpmFJV+Q2IsIZCIW5hIo6w9s5ttpCi1AkhaQlyOpEhVLWYuzpuv2MWO5HzclNjD3vsxFpG9IJwgrYaHtSiqsuw+wvap+B+71IRWDtIWIoXuaiAq9lOGjJO7GvXrV6mNxj2NjS1EpTXzIawmoVwsvduWH+jrcjynBeTORrknsLddfrEuOjwIKnQWyxEiUaIEgwSggUuqtP5fZHIzy8+cXTn7JkzTPMvulAaRAifdvWz8zFwL2FyX8s6Kch5sRsGItjkMIs6vRqJEBUTmiIL5KnuKRUkosVIDILppgQCKTepv59IQ576QUtcpCEWs2Ju1NH9JIclE0+LacienXg7FqTAKtpqajwVBqqnPXJxRdmpksqMc3CEroi88ezJ5X7d5Pj5ePhu2p41dYoVIcVsScRX2DRkFBGLaSP5OhtV3sA+wWA+G3HHLZmZM3364xUVk63FYx54StXkGiMWSF2SHc538t2UZBQhy9InEYQMSg5uYZNsFW0/8fmPdCgKGZaoDnku6j92giCYuSUzkb7+q3o/P078fQOsD0+wS4mi/mLaJmdEvV7PvJSOjCL+uXc/XeE8NFOMoGnfpE3tvv2HLtzziqCvPksSiy3sEAVPEgvHYncnbxFN+/XwJpSWBESLOX4uBoGiaNo7qqa9TPcxYItoOMkYvGGQYke/QY0hY3airLx62R5Ur+t7el3cQjz1DQ1lfJ+4NqyzC4HQDNkVH1E5Fmub9cVns1knBafXrfHqQlLp8PkQIGEVZ6NwzbrVFSj327C42ppQ5nD8EFGNOi1eMqQg68TGBV42m000f6PHNtu8C+ZtZgdBSzT6oksneDCSUboZdLoufiglLkVxJ3/iUIk2knlQ7m9DY3O54wIpSK9vZxJAyeoJyuoVy4f6+gdsPj/yOsCFexsaG85mHU6l3jByLbcSTZMp46yorrY8bC2bix/MwNj0LDhx7OO6azdUWizmE4FgaOrJhsRLF1iLKvY1vp+SnESsWL70x3iqpzo6sfhy4KHXGpsa1/JuXty4aWOp2Wx+BtnwusbmFjKEhY6CwdqHhXU57pVxULKGEwVF2AuiThct4hOSAtuamtk1y3k3L/De/rAg6K5r73SOCKAghJ/OJoCSkycomOCPS7K87RR/6aFgpELY5sEjia8G42DrllsmwQN3Io0/0OnsEjqciemE6+5BqXEN72YkJ09QkKEewcsR8nhizcBIFcEjHXNq5mzlppy5Zv3a83CtP0LAg612BwTQpYCOKduQkbQ/0/NyIWdPUFbVLt8dCoVv6OWFWTJw+0GXy7VycGgwsUql4PqN182tqppcq0SV+7w+3+Sm5lYyqkrGhmvtampqvC1uyc64RHz78sum2iaV9jo6uumNuHU0CIPXcGz3FVcsalVVpY9+TiouLpohEGEa+utVNba2v99t7OruIUFaxY4Bp/tRKXzHbrd/zk1ZGZcISu2ypXtCYWk9Ui63pAfxzrY4GgmH8d4hZ/4QjkHYgfT9AO/mRM5zYhif33dvSXHRyOtjJhQlykKFbvRTTDYBYECOyE/z/ZwZt4gPPvrYgbA4VlFu45b0WLDS20xGIiKmRH3idTMd8MITCKNTvJsz4xZBkeXIfdaSIl6KpId+DPg6IvYVg5mUZPEcBPTiejt5d1xMSMTB997fj8nbYptk5ZYvY8I7ASYzuRzzv1kUSC32M3kD19tR31CfWx0/hgmJoOCm95fZSuENbhiDGWFUicV2CjzwYChANuBW6eYRrnXc7/fn/BV8LBMWsXf/wVfwUJ7S0i97g4aZ3iCS72Lk3w1jUiMdB4rMZCoVkVr1b3tO9SQWi3EyYREUxPFd5bbE17phaCjhGJkvR8nVooHsMliIWY6QGzSElDj6KxG8cNDusO/m3QmRl4h9Bw49K4o6j9VaHF9x+CCbTQbyNTysJxwmG/yD5Cb/ELneN0gWoWQxJpUtFHhzJ0qP1CtnjuQlAq+QmqIo91eWj7zo4aEQSngnnx5Ryb+xwBmNJmLE621UryevagpZKIwKqTcwmel/HHmRlwhKWJL+hgcPFxfF37MNBgPxYGF7dmiAvKGO/vLxTNBP3vQOsiIS4UYr4D/xQ3mR058smWjvcEZmzZxhxsJ2hdcfYB+e6WeesZmIrSnY4gJY9OxCefE7djBP8vYEBeHzGyxsMRPSKoU+cLqFkB0jgleSpF3clDcFEfH6v/Z6FFV9sjJTKZL8fiaQJxztjpO8lzcFEUGRJXmHBRXr8P8OyYzxSj8Kwmf4fkEomAiUIm5M1GcryrIWhjvb29sTXxwKQMFEUALB4D3pynT2Dx0hffDKhIq8TBRUxKH3PnDjze3FyorEupEcSshcD9XXT6zIy0RBRVDCUvgRawpvINSOQ9ALvFtQCi7i4LvvN2AVP5L8DygFIh4vxB/3qSi4CIoky3eXWhP/gKLI+6itrW3CpXY2vhIRmBsf6vX6hVOrKj+HgA6E0WPwTvJK8f8FaqnUS/cZzvC/CCH/BepkbOifdk4kAAAAAElFTkSuQmCC'
	        };
	

	        var locations = [];
				for (i = 0; i < shops.length; i++) {        
	        var temp = [
	        	["<div class='tooltip'><span class='tooltiptext'>Open Inspection Form</span><a href=# onclick='OpenPDF();'><i class='fas fa-file-pdf'></i></a></div>" + " " +  "<b style='font-weight:bold' class='titleTxt'>" + shops[i][0] + "</b>" + "<br/>" + shops[i][1] + "</b><br/>" + shops[i][2] + "<br/>" + "<br/>" + "<span class='phone'> </span><span class='phoneTxt'>" + shops[i][3] + "</span></b><br/>" + "<span class='fax'> </span><span class='faxTxt'>" + shops[i][4] + "</span></b><br/>" + "<a id='email'> <i class='email'></i> <a href='mailto:" + shops[i][5] + "'>" + shops[i][5] + "</a></a>"],
	        			];
	        		locations.push(temp);
	        	}
	        var alldestinations = [];
				for (i = 0; i < shops.length; i++) {
					alldestinations.push(shops[i][1] + shops[i][2]);
				}
	        var i;
	        var j;
	        var infowindow;
	        var activeInfoWindow;
	        var resetBounds;
	        var map;
	        var markers = [];
	        var tempmarker = [];
	        var shopmarkers = [];
			var Mycounties = [];
			var tempcounties = [];
			var tempDiv;
			var clickCo;
			var myWindow;
		
        function initMap() {
            
            var mapOptions = {
                mapTypeControl: false,
                zoomControl: true,
                zoomControlOptions: { style: google.maps.ZoomControlStyle.SMALL },
                fullscreenControl: false,

                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById('map'),
                mapOptions);
            map = map;

            var originInput = document.getElementById('origin-input');
            var btnClickme = document.getElementById('clickMe');
            var clearMap = document.getElementById('clear');
            var shopList = document.getElementById('listShops');
            map.controls[google.maps.ControlPosition.TOP_CENTER].push(originInput);
            map.controls[google.maps.ControlPosition.TOP_CENTER].push(btnClickme);
            map.controls[google.maps.ControlPosition.TOP_CENTER].push(clearMap);
            map.controls[google.maps.ControlPosition.TOP_CENTER].push(shopList);
            map.controls[google.maps.ControlPosition.TOP_LEFT].push(testDiv);
            

            var southWest = new google.maps.LatLng(39.801519, -89.620634);
            var northEast = new google.maps.LatLng(42.37009, -87.63416000000001);
            var bounds = new google.maps.LatLngBounds(southWest, northEast);
            var listener = google.maps.event.addListener(map, "idle", function () {
                map.fitBounds(bounds);
                google.maps.event.removeListener(listener);
            });
            map.addListener('tilesloaded', function () {
                document.getElementById("origin-input").innerHTML = 'Tilesloaded Event';
                window.setTimeout(function () {
                    document.getElementById("origin-input").focus();
                }, 100);
            });

            var marker;
            var latlngbounds = new google.maps.LatLngBounds();
            for (i = 0; i < shops.length; i++) {

                marker = new google.maps.Marker({
                    position: new google.maps.LatLng(shops[i][6], shops[i][7]),
                    map: map,
                    clickable: true,
                    title: shops[i][0],
                    icon: image

                });

				shopmarkers.push(marker);
                infowindow = new google.maps.InfoWindow();

                google.maps.event.addListener(marker, 'click', (function (marker, i) {

                    return function () {
                        var regex = /mi/gi;
                        var shopDist = [];
						 
						var dist = document.getElementById("dist" + i);
					if (typeof(dist) != 'undefined' && dist != null)
					{
					  var shopDist = [
						  [dist.innerHTML.replace(regex, "miles away")], 
                        ];
					}
						                      					
						if (originInput.value == "Enter an origin location"){
							shopDist = [];
						}else
                        document.getElementById("markerPos").innerHTML = marker.getPosition();
                        infowindow.setContent("<div class='scrollFix'>" + locations[i][0] + "</b><br/>" + "</b><br/>" + "<div id='windowDiv' class='windowTxt'>" + shopDist + "</div>" + "<i class='arrows'> </i><input id='iwButton' type='button' onClick='getDir()' value='Get Directions' class='button3'>" +
                            "</b><br/>" + "<div style='text-align: right; font-weight: bold; color: red'>" + shops[i][8] + "</div>" + "<input id='clientAddress' type='text' style='display: none;'></div>")

                        infowindow.open(map, marker);
                        activeInfoWindow = infowindow;
						var inputAddress = document.getElementById("clientAddress");
						if (shops[i][5] == ""){
						document.getElementById("email").style.display = "none";
						}
						if (inputAddress == null){
						map.setZoom(10);
                        map.setCenter(marker.getPosition());
						}else
                        document.getElementById("clientAddress").value = document.getElementById("origin-input").value;
                        map.setZoom(10);
                        map.setCenter(marker.getPosition());

                    }

                })(marker, i));
                markers.push(marker);
                latlngbounds.extend(marker.position);

                resetBounds = latlngbounds;
                geocoder = new google.maps.Geocoder();
                directionsService = new google.maps.DirectionsService();
                directionsDisplay = new google.maps.DirectionsRenderer({
                    suppressMarkers: true
                });
                directionsDisplay.setMap(map);
                directionsDisplay.setPanel(document.getElementById("directionsPanel"));

                google.maps.event.addListener(map, "click", function (event) {
                    infowindow.close();
                    map.setCenter(latlngbounds.getCenter());
                    map.fitBounds(latlngbounds);

                });

                var inputtest = document.getElementById("origin-input");
                inputtest.addEventListener('click', function () {
                    infowindow.close();

                    var bounds = new google.maps.LatLngBounds();
                    map.setCenter(latlngbounds.getCenter());
                    map.fitBounds(latlngbounds);
                    clearDir();
                });

            }
            new AutocompleteDirectionsHandler(map);
           
         
			 Mycounties.infoWindow = new google.maps.InfoWindow();         
			 for (i = 0; i < countyCoords.length; i++) {           
			Mycounties = new google.maps.Polygon({
			          paths: eval('countyCoords[i].coord'),
			          strokeColor: '#FF0000',
			          strokeOpacity: 0.5,
			          strokeWeight: 1,
			          fillColor: '#FF0000',
			          fillOpacity: 0.2
			        });
			tempcounties.push(Mycounties);

		function attachPolygonInfoWindow(Mycounties, html) {
		
			Mycounties.infoWindow = new google.maps.InfoWindow({
				content: "<div style='width: 250px; position: fixed; bottom: 50%; right: 0; border: 1px solid red; background: rgb(255, 255, 255); padding: 2px; font: 12px arial;'><div style='padding:2px;font: normal 10px verdana; background: #990000;'><div id='infoDiv' style='font: bold 12px verdana;margin:3px;padding:3px;color:#ffffff'><table cellspacing='2' cellpadding='0'><tbody><tr><td width='45'><img src='IL.png'></td><td valign='top' style='padding-left: 5px'>Illinois<br>" + html + "<br></td></tr></tbody></table></div></div></div>",
				
			});
			google.maps.event.addListener(Mycounties, 'mouseover', function(e) {
				 
			});
		
			google.maps.event.addListener(Mycounties, 'mouseout', function() {
						
			});
			google.maps.event.addListener(Mycounties, 'doubleclick', function(e) {
			var latLng = e.latLng;
			map.setCenter(latLng);
			map.setZoom(9);
			
			});
			google.maps.event.addListener(Mycounties, 'click', function(e) {
			myWindow = document.getElementById("infoDivWrapper");
			document.getElementById("divTD").innerHTML = "Illinois<br>" + html + "<br>";
			if (clickCo == null) {
				}else
			if (clickCo.fillOpacity == .1){
			clickCo.setOptions({fillOpacity:0.2});
			myWindow.style.display = "none";
			}
		
			if (this.fillOpacity == .2){
			this.setOptions({fillOpacity:0.1});
			myWindow.style.display = "inherit";
			}

			clickCo = this;
			document.getElementById("origin-input").focus();
			});
			
		}

			attachPolygonInfoWindow(Mycounties, eval('countyCoords[i].name'));

       }
		
		
}
   

        
    </script>
                <div id="testDiv" class="customMapControldropdown">
                    <button id="mapButton" class="customMapControlwrapper" disabled>Map</button>
                    <div class="customMapControldropdown-content">
                        <a class="customMapControl" id="mapControlDiv" href=# onclick="clearDir();" style="display: none;" />Map</a>
                        <a class="customMapControl" id="centerControlDiv" href=# onclick="countiesDiv();" />Counties</a>
                        <a class="customMapControl" id="satControlDiv" href=# onclick="satMap();" />Satellite</a>
                    </div>
                </div>
                
    <input id="origin-input" class="controls" type="text"
           placeholder="Enter an origin location">

	 <label for "orig" style="display: none;">Origin:</label>
    <input id="orig" type="text" style="display: none;" readonly class="originput">
    <button id="clear" onClick="clearDir();" / class="button1">CLEAR</button>
    <button id="listShops" onclick="GenerateTable();" / class="button1">LIST</button>
    <button id="clickMe" onclick="clicky();" / class="button1" disabled>SEARCH</button>
	
	<div class="column1" id="map"></div>
	<div class="column2" id="wholetable">
	

        <div id="main" class="clear">
            <div id="sidebar">
                <div class="dropdown">
                    <button class="btn2" disabled><b>SORT SHOPS</b></button>
                    <div class="dropdown-content">
                        <a id="sortMe"  href=# onclick="sortTime();" /><i class="fas fa-clock"> by Travel Time</i></a>
                        <a id="sortMe2"  href=# onclick="sortDist();" /><i class="fas fa-map-marked-alt"> by Travel Distance</i></a>
                    </div>
                </div>
            </div>                
            <div id="page-wrap">
                <center class="sortTxt" id="sortedBy"></center>
            </div>
        </div>
        <form id="myForm">
            <table id="myTable" >
                <colgroup>
                    <col style="background-color:white">
                </colgroup>
                
            </table>
        </form>
    </div>
	<div id="directionsPanel"></div>
	<div id="dvTable"></div>
	<div id="output"></div>
	<div id="dvPopup" style="display: none; width: 310px; position: fixed; bottom: 95%; left: 0%; border: 1px solid red; background: rgb(250, 255, 165); padding: 2px; font: 12px arial; font-weight: bold;">Shops with towing capability marked with asterisk (*)</div>

    <p id="markerPos" style="display: none;"</p>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCRZn_UmJKVoBZEsDc6UwFPAGRPf04OEWQ&libraries=places&callback=initMap"
            async defer></script>
    
<div id="infoDivWrapper" style="display: none; width: 250px; position: fixed; bottom: 50%; right: 0; border: 1px solid red; background: rgb(255, 255, 255); padding: 2px; font: 12px arial;">
<div style="padding:2px;font: normal 10px verdana; background: #990000;">
<div id="infoDiv" style="font: bold 12px verdana;margin:3px;padding:3px;color:#ffffff">
<table cellspacing="2" cellpadding="0">
<tbody>
<tr>
<td width="45"><img src="IL.png">
</td>
<td id="divTD" valign="top" style="padding-left: 5px">
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


</body>

</html>
